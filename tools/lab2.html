<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Inventaris Laptop Lab 2</title>

<style>
body{
    margin:0;
    font-family:"Segoe UI",Arial,sans-serif;
    background:#f1f5f9;
}

/* HEADER */
.top-header {
    display:flex;
    align-items:center;
    gap:15px;
    background:#2563eb;
    padding:15px 20px;
    border-radius:0 0 15px 15px;
    box-shadow:0 3px 8px rgba(0,0,0,0.3);
    color:#fff;
}
.top-header img{
    height:50px;width:50px;
    border-radius:10px;
    background:#fff;
}
.top-header h1{margin:0;font-size:20px;}
.top-header p{margin:0;font-size:12px;color:#e0e7ff;}

.container{
    padding:20px;
    max-width:1200px;
    margin:auto;
}

/* SUMMARY */
.summary{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:15px;
    margin-bottom:25px;
}
.card{
    background:#fff;
    padding:15px;
    border-radius:14px;
    box-shadow:0 4px 10px rgba(0,0,0,.08);
}
.card h3{margin:0;font-size:14px;color:#64748b;}
.card span{font-size:28px;font-weight:700;}

/* MAP */
.map-box{
    background:#fff;
    padding:20px;
    border-radius:16px;
    box-shadow:0 4px 10px rgba(0,0,0,.1);
}
.map-grid{
    display:grid;
    grid-template-columns:repeat(11,55px);
    gap:8px;
}

.meja{
    width:55px;height:55px;
    border-radius:10px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 3px 6px rgba(0,0,0,.15);
}
.normal{background:#22c55e;color:#fff;}
.ringan{background:#facc15;}
.berat{background:#ef4444;color:#fff;}
.kosong{visibility:hidden;}

.meja-guru{
    grid-column:8/12;
    background:#38bdf8;
    color:#fff;
    text-align:center;
    padding:10px;
    border-radius:10px;
    font-weight:600;
}

/* MODAL */
.modal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.5);
    display:none;
    align-items:center;
    justify-content:center;
}
.modal-box{
    background:#fff;
    padding:20px;
    border-radius:14px;
    width:300px;
}
.modal-box button{
    margin-top:10px;
    padding:8px 12px;
    border:none;
    background:#2563eb;
    color:#fff;
    border-radius:8px;
    cursor:pointer;
}
</style>
</head>

<body>

<header class="top-header">
  <img src="assets/logo.jpg">
  <div>
    <h1>Dashboard Inventaris Laptop</h1>
    <p>Lab Komputer 2</p>
  </div>
</header>

<div class="container">

<!-- SUMMARY -->
<div class="summary">
    <div class="card"><h3>Total Laptop</h3><span id="total">0</span></div>
    <div class="card"><h3>Normal</h3><span id="normal">0</span></div>
    <div class="card"><h3>Rusak Ringan</h3><span id="ringan">0</span></div>
    <div class="card"><h3>Rusak Berat</h3><span id="berat">0</span></div>
</div>

<!-- MAP -->
<div class="map-box">
<h3>Denah Meja Laptop</h3>
<div class="map-grid" id="mapGrid"></div>
</div>

</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <div id="modalContent"></div>
    <button onclick="modal.style.display='none'">Tutup</button>
  </div>
</div>

<script>
const SHEET_ID="14Trwaf9K__WczN1hARNDSeL0knx5KCxA";
const INV_URL=`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=INV`;

let INV=[];

/* DENAH SESUAI GAMBAR */
const DENAH=[
 [22,21,20,19,18,17,"",4,3,2,1],
 [28,27,26,25,24,23,"",8,7,6,5],
 [34,33,32,31,30,29,"",12,11,10,9],
 [40,39,38,37,36,35,"",16,15,14,13]
];

fetch(INV_URL).then(r=>r.text()).then(t=>{
 const j=JSON.parse(t.substring(47,t.length-2));
 const h=j.table.cols.map(c=>c.label);
 INV=j.table.rows.map(r=>{
   let o={};r.c.forEach((c,i)=>o[h[i]]=c?c.v:"");return o;
 });
 renderSummary();
 renderMap();
});

function renderSummary(){
 total.textContent=INV.length;
 normal.textContent=INV.filter(i=>i.Kondisi==="Normal").length;
 ringan.textContent=INV.filter(i=>i.Kondisi==="Rusak Ringan").length;
 berat.textContent=INV.filter(i=>i.Kondisi==="Rusak Berat").length;
}

function renderMap(){
 const g=document.getElementById("mapGrid");
 DENAH.forEach(r=>{
  r.forEach(n=>{
   const d=document.createElement("div");
   if(n===""){d.className="meja kosong";g.appendChild(d);return;}
   const i=INV.find(x=>String(x["NO MEJA"])===String(n));
   let c="normal";
   if(i){
    if(i.Kondisi==="Rusak Ringan")c="ringan";
    if(i.Kondisi==="Rusak Berat")c="berat";
   }
   d.className=`meja ${c}`;
   d.textContent=n;
   if(i)d.onclick=()=>show(i);
   g.appendChild(d);
  });
 });
}

function show(i){
 modalContent.innerHTML=`
 <b>No Meja:</b> ${i["NO MEJA"]}<br>
 <b>Barang:</b> ${i["NAMA BARANG"]||"-"}<br>
 <b>Kondisi:</b> ${i.Kondisi}<br>
 <b>Keterangan:</b> ${i.Keterangan||"-"}
 `;
 modal.style.display="flex";
}
</script>

</body>
</html>
