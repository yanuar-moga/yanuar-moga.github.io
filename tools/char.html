<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Analisis Karakter Siswa</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #eef2f7;
  padding: 20px;
}
.card {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  max-width: 1200px;
  margin: auto;
}
h2 { margin-top: 0; }
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
th, td {
  border: 1px solid #ccc;
  padding: 6px;
  font-size: 13px;
}
th {
  background: #2c7be5;
  color: #fff;
}
.good { background: #d4edda; }
.mid { background: #fff3cd; }
.low { background: #f8d7da; }
</style>
</head>

<body>
<div class="card">
  <h2>ðŸ“Š Analisis Karakter Siswa (Excel)</h2>
  <input type="file" id="fileInput" accept=".xlsx,.xls">

  <table id="result">
    <thead>
      <tr>
        <th>No</th>
        <th>Nama Siswa</th>
        <th>Nilai</th>
        <th>Karakter</th>
        <th>Kekurangan</th>
        <th>Perbaikan</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
document.getElementById("fileInput").addEventListener("change", handleFile);

function handleFile(e) {
  const file = e.target.files[0];
  const reader = new FileReader();

  reader.onload = function(evt) {
    const data = new Uint8Array(evt.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];

    // Ambil range A8:Y39
    const rows = XLSX.utils.sheet_to_json(sheet, {
      header: 1,
      range: "A8:Y39"
    });

    const tbody = document.querySelector("#result tbody");
    tbody.innerHTML = "";

    rows.forEach((row, i) => {
      if (!row[1]) return;

      const nilai = parseFloat(row[2]) || 0;
      const analisis = analisaNilai(nilai);

      const tr = document.createElement("tr");
      tr.className = analisis.class;

      tr.innerHTML = `
        <td>${row[0] || i+1}</td>
        <td>${row[1]}</td>
        <td>${nilai}</td>
        <td>${analisis.karakter}</td>
        <td>${analisis.kekurangan}</td>
        <td>${analisis.perbaikan}</td>
      `;
      tbody.appendChild(tr);
    });
  };

  reader.readAsArrayBuffer(file);
}

function analisaNilai(n) {
  if (n >= 90) return {
    karakter: "Sangat Baik & Mandiri",
    kekurangan: "Kurang kolaborasi",
    perbaikan: "Latih kerja tim",
    class: "good"
  };
  if (n >= 80) return {
    karakter: "Baik & Bertanggung Jawab",
    kekurangan: "Percaya diri",
    perbaikan: "Lebih aktif berdiskusi",
    class: "good"
  };
  if (n >= 70) return {
    karakter: "Cukup",
    kekurangan: "Konsistensi",
    perbaikan: "Jadwal belajar rutin",
    class: "mid"
  };
  if (n >= 60) return {
    karakter: "Kurang",
    kekurangan: "Motivasi belajar",
    perbaikan: "Pendampingan guru",
    class: "mid"
  };
  return {
    karakter: "Perlu Pembinaan",
    kekurangan: "Disiplin & pemahaman",
    perbaikan: "Bimbingan intensif",
    class: "low"
  };
}
</script>
</body>
</html>
